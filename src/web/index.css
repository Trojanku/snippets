@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --color-paper: 245 242 236;
  --color-paper-deep: 236 231 222;
  --color-ink: 33 31 28;
  --color-ink-soft: 103 97 90;
  --color-line: 206 198 184;
  --color-line-strong: 176 166 150;
  --color-focus: 98 131 113;
  --color-accent: 109 142 124;
  --color-accent-soft: 225 235 227;
  --color-danger: 174 89 75;
  --color-danger-soft: 247 231 226;
  --color-caution: 195 150 95;
  --color-success: 58 111 76;
}

html.light {
  color-scheme: light;
}

html.dark {
  --color-paper: 19 22 24;
  --color-paper-deep: 14 16 18;
  --color-ink: 236 234 228;
  --color-ink-soft: 171 166 157;
  --color-line: 62 65 69;
  --color-line-strong: 91 95 100;
  --color-focus: 145 189 162;
  --color-accent: 129 168 144;
  --color-accent-soft: 36 46 41;
  --color-danger: 211 120 102;
  --color-danger-soft: 56 33 29;
  --color-caution: 220 173 114;
  --color-success: 122 188 145;
  color-scheme: dark;
}

@media (prefers-color-scheme: dark) {
  html:not(.light) {
    --color-paper: 19 22 24;
    --color-paper-deep: 14 16 18;
    --color-ink: 236 234 228;
    --color-ink-soft: 171 166 157;
    --color-line: 62 65 69;
    --color-line-strong: 91 95 100;
    --color-focus: 145 189 162;
    --color-accent: 129 168 144;
    --color-accent-soft: 36 46 41;
    --color-danger: 211 120 102;
    --color-danger-soft: 56 33 29;
    --color-caution: 220 173 114;
    --color-success: 122 188 145;
  }
}

@layer base {
  * {
    @apply box-border m-0;
  }

  html,
  body,
  #root {
    min-height: 100%;
  }

  body {
    @apply font-sans text-ink leading-1.6 antialiased transition-colors duration-200;
    background-color: rgb(var(--color-paper));
    background-image:
      radial-gradient(circle at 12% 0%, rgba(var(--color-accent), 0.15) 0, transparent 36%),
      radial-gradient(circle at 100% 88%, rgba(var(--color-line-strong), 0.15) 0, transparent 44%);
  }
}

@layer components {
  .panel {
    @apply border border-line/80 rounded-2xl bg-paper/80 backdrop-blur;
    box-shadow: 0 14px 36px rgba(12, 14, 16, 0.08);
  }

  .panel-subtle {
    @apply border border-line/70 rounded-xl bg-paper-deep/35;
  }

  .surface {
    @apply panel p-5;
  }

  .control {
    @apply border border-line bg-paper/70 rounded-lg px-3 py-2 text-sm text-ink transition-colors;
  }

  .control:hover {
    @apply border-line-strong bg-paper;
  }

  .control::placeholder {
    color: rgb(var(--color-ink-soft) / 0.7);
  }

  .btn {
    @apply rounded-full border px-3 py-1.5 text-xs tracking-widest uppercase transition-colors;
  }

  .btn-muted {
    @apply btn border-line/70 bg-paper/45 text-ink-soft hover:border-line hover:bg-paper hover:text-ink;
  }

  .btn-accent {
    @apply btn border-line-strong bg-accent-soft text-ink hover:border-focus;
  }

  .chip {
    @apply text-xs rounded-full px-2 py-0.5 tracking-widest uppercase border border-line bg-paper-deep/60 text-ink-soft;
    font-size: 10px;
  }

  .status {
    @apply text-xs tracking-widest uppercase px-2 py-0.5 rounded-full border;
    font-size: 10px;
  }

  .status-raw {
    @apply bg-paper-deep/70 text-ink-soft border-line;
  }

  .status-processed {
    @apply bg-accent-soft/80 text-success border-success/30;
  }

  .status-queued {
    @apply bg-paper/90 text-ink-soft border-line;
  }

  .status-processing {
    @apply text-ink-soft border-line;
    background: linear-gradient(
      90deg,
      rgba(var(--color-paper), 0.9),
      rgba(var(--color-accent-soft), 0.7),
      rgba(var(--color-paper), 0.9)
    );
    background-size: 200% 100%;
    animation: mist-shift 3s ease-in-out infinite;
  }

  .status-failed {
    @apply bg-danger-soft text-danger border-danger/40;
  }

  .badge {
    @apply chip;
  }

  .action-clear {
    @apply text-success border-success/35 bg-accent-soft/70;
  }

  .action-maybe {
    @apply text-caution border-caution/35 bg-caution/10;
  }

  .note-row {
    @apply flex flex-col gap-2 py-4 px-3 text-left w-full text-ink border-b border-line/60 transition-colors rounded-lg;
  }

  .note-row:hover {
    @apply bg-paper/65;
  }

  .note-content p,
  .note-content ul,
  .note-content ol,
  .note-content blockquote {
    margin: 0 0 1.05em;
  }

  .note-content h1,
  .note-content h2,
  .note-content h3,
  .note-content h4 {
    @apply font-serif leading-tight;
    margin: 1.2em 0 0.6em;
  }

  .note-content code {
    @apply bg-paper-deep/80 px-1 py-0.5 rounded;
    font-size: 0.86em;
  }

  .note-content a {
    @apply text-focus;
  }

  .tree-node {
    @apply space-y-1;
  }

  .tree-branch {
    @apply ml-4 border-l border-line/40 pl-3;
  }

  .tree-toggle {
    @apply h-7 w-7 min-w-7 rounded-md border border-line/55 bg-paper/30 text-xs leading-none text-ink-soft transition-colors hover:border-line-strong hover:bg-paper hover:text-ink;
  }

  .tree-folder {
    @apply flex-1 rounded-lg border px-2.5 py-1.5 text-left text-sm transition-colors;
  }

  .tree-folder-idle {
    @apply tree-folder border-transparent text-ink-soft hover:border-line/70 hover:bg-paper/65 hover:text-ink;
  }

  .tree-folder-active {
    @apply tree-folder border-line-strong bg-accent-soft/80 text-ink;
  }

  .tree-pill {
    @apply min-w-[2rem] rounded-full border px-1.5 py-1 text-center text-[11px] leading-none;
  }

  .tree-pill-idle {
    @apply tree-pill border-line bg-paper/70 text-ink-soft;
  }

  .tree-pill-active {
    @apply tree-pill border-line-strong bg-accent-soft text-ink;
  }
}

@layer utilities {
  button:focus-visible,
  input:focus-visible,
  textarea:focus-visible,
  select:focus-visible {
    @apply outline-2 outline-offset-2;
    outline-color: rgb(var(--color-focus));
  }
}

@keyframes mist-shift {
  0% {
    background-position: 0% 50%;
  }

  50% {
    background-position: 100% 50%;
  }

  100% {
    background-position: 0% 50%;
  }
}
